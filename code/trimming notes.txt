#(phipflow) [bek321@compute-e-16-230 220b26f2462bffce469fa0deb0d90e]$ zcat FC_07332_GEN00227896.fastq.gz | bowtie   -5 17 -3 50 -l 30 -e 1000   --threads 2   -n 2   --tryhard --nomaqround --norc --best --sam --quiet   -x peptide_index/peptide - > test.sam
# reads processed: 24337
# reads with at least one alignment: 24337 (100.00%)
# reads that failed to align: 0 (0.00%)


###

for cr in 75 50
do
        for hd in 25 20 17 15 10 5 0
        do
                cd /n/scratch/users/b/bek321/phageIP_PASC/data-raw/fastq/

                for infile in FC_07336_GEN00228373.fastq.gz FC_07336_GEN00228374.fastq.gz FC_07266_GEN00227705.fastq.gz FC_07266_GEN00227706.fastq.gz FC_07266_GEN00227707.fastq.gz FC_07272_GEN00227735.fastq.gz FC_07332_GEN00227897.fastq.gz FC_07332_GEN00227898.fastq.gz
                do
                        base=$(basename ${infile} .fastq.gz)
                        trimmomatic SE -threads 2 ${infile} ${base}_1.trim.fastq.gz CROP:${cr} HEADCROP:${hd} SLIDINGWINDOW:4:20 MINLEN:25 ILLUMINACLIP:/n/scratch/users/b/bek321/phageIP_PASC/data-raw/peptide_table/VIR3_clean.adapt.fa:2:30:10 &
                done

                wait
                wait

                cd /n/scratch/users/b/bek321/phageIP_PASC/data-final

                for n in 2 3
                do
                        for readlen in 0 50
                        do
                                for olen in 50 168
                                do
                                        nextflow run matsengrp/phip-flow -r V1.12  \
                                                --sample_table ../data-raw/20231219_PASC_samples.DEBUG.trim \
                                                --peptide_table ../data-raw/peptide_table/VIR3_clean.csv \
                                                --read_length $readlen --oligo_tile_length $olen \
                                                --n_mismatches $n \
                                                --peptide_seq_col Prot \
                                                --output_wide_csv \
                                                --sample_grouping_col sample_name \
                                                --results 20231219_PASC_phipflow_SEARCH2_debug_trim${cr}.${hd}_n${n}_rd${readlen}_pep${olen}_"$(date -I)" \
                                                -resume
                                done
                        done
                        
                done
        done
done

***crop & head crop are the only strongly impactful parameters
